{"version":3,"sources":["app.js","app.min.js","canvas.js"],"names":["clearAll","node","document","getElementById","lastChild","deleteCanvas","addCanvas","debounce","func","timer","event","clearTimeout","setTimeout","httpGet","theUrl","xmlHttp","XMLHttpRequest","open","send","responseText","startSocket","hash","socket","io","connect","room","on","emit","onDrawingEvent","history","JSON","parse","data","length","forEach","item","createCanvasByData","sharePano","link","s4","Math","floor","random","toString","substring","href","window","location","init","wW","innerWidth","wH","innerHeight","remove","nav","querySelector","e","n","t","repeatOften","requestAnimationFrame","canvasInit","width","height","getContext","o","lineWidth","lineJoin","lineCap","a","drawCanvas","createImage","toDataURL","classList","add","moveOnCanvas","options","isDraw","source","mousePress","intervalDraw","clearInterval","touches","pageX","pageY","push","mouseDown","which","setInterval","SPEED","mouseUp","endLine","removeEventListener","this","restore","addEventListener","canvas","isHistory","ctx","idx","drawing","res","layers","num","canvasId","substr","opacity","color","type","sizeKoof","setColor","colorSelect","value","setOpacity","slider","setLength","setSource","selectObject","setDraw","setType","lineType","val","disabled","wrapper","createElement","setAttribute","appendChild","replace","createNew","src","nodes","querySelectorAll","activeNode","lastNode","splice","evtobj","keyCode","ctrlKey","r","s","i","round","float","sign","lineSize","raf","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","point","x","y","signY","c","line","sX","sY","eX","eY","u","d","radius","beginPath","moveTo","lineTo","cX1","cY1","quadraticCurveTo","arc","PI","l","fillStyle","fill","strokeStyle","stroke","signX","callback","mX","mY","getColor"],"mappings":"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","file":"app.min.js","sourcesContent":["var layers = [];\nvar num = 0;\nvar canvasId = \"#canvas\";\nvar wW = window.innerWidth;\nvar wH = window.innerHeight;\nvar nav = document.querySelector(\"nav\");\nvar intervalDraw;\nvar socket;\nvar hash = window.location.hash.substr(1);\n\nconst SPEED = 1;\nconst options = {\n  opacity: 0.6,\n  length: 120,\n  color: '0',\n  source: '1',\n  type: '3',\n  isDraw: true,\n  mousePress: false,\n  endLine: null\n};\noptions.sizeKoof = options.type === '3' ? 5 : 2;\n\n\nconst setColor = function(colorSelect) {\n  options.color = colorSelect.value;\n};\n\nconst setOpacity = function (slider) {\n  options.opacity = slider.value;\n};\n\nconst setLength = function (slider) {\n  options.length = slider.value;\n};\n\nconst setSource = function(selectObject) {\n  clearInterval(intervalDraw);\n\n  options.source = selectObject.value;\n  options.endLine = null;\n\n  if (options.source == '0') {\n    nav.classList.remove('mouse');\n    setDraw(false);\n  } else {\n    nav.classList.add('mouse');\n    setDraw(true);\n  }\n};\n\nconst setType = function(lineType) {\n  options.type = lineType.value;\n  options.endLine = null;\n  options.sizeKoof = (lineType.value === '3') ? 5 : 2;\n};\n\nconst setDraw = function(val) {\n  options.isDraw = val;\n  const canvas = document.getElementById(layers[layers.length - 1]);\n\n  if (document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = val;\n  }\n\n  if (val) {\n    nav.classList.add('active')\n\n    if (options.source === '0') {\n      intervalDraw = setInterval(function() {\n        drawCanvas(canvas)\n      }, Math.floor(Math.random() * (SPEED - (SPEED / 2) + (SPEED / 2)) * 100) / 100)\n    }\n  } else {\n    nav.classList.remove('active')\n    if (intervalDraw) {\n      clearInterval(intervalDraw);\n    }\n\n    if (hash) {\n      socket.emit('drawing', canvas.toDataURL());\n    }\n\n    addCanvas();\n  }\n};\n\nvar addCanvas = function() {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"canvas\");\n\n  canvasId = \"canvas\" + num;\n  node.setAttribute(\"id\", canvasId);\n  wrapper.appendChild(node);\n\n  var canvas = document.getElementById(canvasId);\n  layers.push(canvasId);\n\n  if (layers.length > 1 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = false;\n  }\n  \n  canvasInit(canvas)\n\n  num++;\n};\n\nvar createCanvasByData = function(data, isHistory) {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"canvas\");\n  \n  canvasId = \"canvas\" + num;\n  node.setAttribute(\"id\", canvasId);\n  wrapper.appendChild(node);\n  \n  var canvas = document.getElementById(canvasId);\n  layers.push(canvasId);\n  \n  if (layers.length > 1 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = false;\n  }\n  \n  canvasInit(canvas, data, isHistory)\n  \n  num++;\n};\n\nvar createImage = function(data, replace, createNew) {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"img\");\n  node.src = data;\n\n  if (replace) {\n    const nodes = wrapper.querySelectorAll('canvas:not(.active)');\n    const activeNode = wrapper.querySelector('canvas.active');\n    var lastNode = nodes[nodes.length- 1];\n    if (lastNode) {\n      lastNode.remove();\n    } else {\n      activeNode.remove();\n    }\n  }\n  wrapper.appendChild(node);\n\n  if (createNew) {\n    addCanvas();\n  }\n};\n\nvar deleteCanvas = function(n) {\n  var node = document.getElementById(layers[layers.length - 2 + (n ? n : 0)]);\n  node.remove();\n\n  layers.splice(layers.length - 2 + (n ? n : 0), 1);\n\n  if (layers.length < 2 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = true;\n  }\n\n  if(layers.length === 0) {\n    addCanvas();\n  }\n};\n\nfunction clearAll() {\n  var node = document.getElementById('wrapper');\n  while (node.lastChild) {\n    deleteCanvas()\n  }\n\n  addCanvas();\n}\n\nwindow.addEventListener('keydown', function(e) {\n  var evtobj = window.event ? event : e\n\n  if (evtobj.keyCode == 90 && evtobj.ctrlKey) {\n\n    if (layers.length > 1) {\n      deleteCanvas();\n    }\n  }\n});\n\nfunction debounce(func) {\n  var timer;\n\n  return function(event) {\n    if (timer) clearTimeout(timer);\n\n    timer = setTimeout(func, 300, event);\n  };\n}\n\nwindow.addEventListener(\"resize\", debounce(function() {\n  wW = window.innerWidth;\n  wH = window.innerHeight;\n\n  deleteCanvas(1);\n  addCanvas();\n}));\n\nvar onDrawingEvent = function(data) {\n  createCanvasByData(data, false);\n};\n\nfunction httpGet(theUrl) {\n  var xmlHttp = new XMLHttpRequest();\n  xmlHttp.open( \"GET\", theUrl, false ); // false for synchronous request\n  xmlHttp.send( null );\n  return xmlHttp.responseText;\n}\n\nfunction startSocket(hash) {\n  socket = io.connect();\n  var room = 'room-' + hash;\n\n  socket.on('connect', function() {\n    socket.emit('room', room);\n  });\n\n  socket.on('drawing', onDrawingEvent);\n\n  const history = JSON.parse(httpGet('/history?room=' + room)).data;\n\n  if (history && history.length > 0) {\n    history.forEach(item => {\n      createCanvasByData(item, true);\n    })\n  }\n}\n\nfunction sharePano(link) {\n  function guid() {\n    function s4() {\n      return Math.floor((1 + Math.random()) * 0x10000)\n        .toString(16)\n        .substring(1);\n    }\n    return s4() + s4();\n  }\n\n  const hash = guid();\n\n  link.href = window.location + '#' + hash\n}\n\nfunction init() {\n  wW = window.innerWidth;\n  wH = window.innerHeight;\n\n  if (hash) {\n    document.getElementById('clearBtn').remove();\n    document.getElementById('undoBtn').remove();\n    document.getElementById('shareBtn').remove();\n    startSocket(hash);\n  }\n\n  nav = document.querySelector(\"nav\");\n\n  addCanvas();\n}\n","\"use strict\";function clearAll(){for(var e=document.getElementById(\"wrapper\");e.lastChild;)deleteCanvas();addCanvas()}function debounce(e){var n;return function(t){n&&clearTimeout(n),n=setTimeout(e,300,t)}}function httpGet(e){var n=new XMLHttpRequest;return n.open(\"GET\",e,!1),n.send(null),n.responseText}function startSocket(e){socket=io.connect();var n=\"room-\"+e;socket.on(\"connect\",function(){socket.emit(\"room\",n)}),socket.on(\"drawing\",onDrawingEvent);var t=JSON.parse(httpGet(\"/history?room=\"+n)).data;t&&t.length>0&&t.forEach(function(e){createCanvasByData(e,!0)})}function sharePano(e){var n=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()}();e.href=window.location+\"#\"+n}function init(){wW=window.innerWidth,wH=window.innerHeight,hash&&(document.getElementById(\"clearBtn\").remove(),document.getElementById(\"undoBtn\").remove(),document.getElementById(\"shareBtn\").remove(),startSocket(hash)),nav=document.querySelector(\"nav\"),addCanvas()}function repeatOften(e){requestAnimationFrame(repeatOften)}function canvasInit(e,n,t){if(e.width=wW,e.height=wH,e.getContext){var o=e.getContext(\"2d\");if(o.lineWidth=1,o.lineJoin=o.lineCap=\"round\",n)n.forEach(function(o,a){t?(drawCanvas(e,null,null,o),a===n.length-1&&createImage(e.toDataURL(),!0)):repeatOften(setTimeout(function(){drawCanvas(e,null,null,o),a===n.length-1&&createImage(e.toDataURL(),!0)},1e3/60))});else{e.classList.add(\"active\");var a=[];e.moveOnCanvas=function(n){if(options.isDraw&&(\"2\"===options.source||\"1\"===options.source&&e.mousePress)){intervalDraw&&clearInterval(intervalDraw);var t=drawCanvas(e,n.touches?n.touches[0].pageX:n.pageX,n.touches?n.touches[0].pageY:n.pageY);t&&a.push(t)}},e.mouseDown=function(n){1===n.which&&(e.mousePress=!0,options.isDraw&&\"1\"===options.source&&(intervalDraw=setInterval(function(){var t=drawCanvas(e,n.touches?n.touches[0].pageX:n.pageX,n.touches?n.touches[0].pageY:n.pageY);t&&a.push(t)},Math.floor(Math.random()*(SPEED-SPEED/2+SPEED/2)*100)/5)))},e.mouseUp=function(){\"2\"!==options.source&&\"1\"!==options.source||(options.endLine=null,intervalDraw&&clearInterval(intervalDraw),e.mousePress&&(hash&&socket.emit(\"drawing\",a),e.removeEventListener(\"mousedown\",this,!1),e.removeEventListener(\"touchstart\",this,!1),e.removeEventListener(\"mousemove\",this,!1),e.removeEventListener(\"touchmove\",this,!1),e.removeEventListener(\"mouseup\",this,!1),e.removeEventListener(\"touchend\",this,!1),createImage(e.toDataURL(),!0,!0))),e.mousePress=!1,o.restore()},e.addEventListener(\"mousedown\",e.mouseDown),e.addEventListener(\"touchstart\",e.mouseDown),e.addEventListener(\"mousemove\",e.moveOnCanvas),e.addEventListener(\"touchmove\",e.moveOnCanvas),e.addEventListener(\"mouseup\",e.mouseUp),e.addEventListener(\"touchend\",e.mouseUp)}}}var layers=[],num=0,canvasId=\"#canvas\",wW=window.innerWidth,wH=window.innerHeight,nav=document.querySelector(\"nav\"),intervalDraw,socket,hash=window.location.hash.substr(1),SPEED=1,options={opacity:.6,length:120,color:\"0\",source:\"1\",type:\"3\",isDraw:!0,mousePress:!1,endLine:null};options.sizeKoof=\"3\"===options.type?5:2;var setColor=function(e){options.color=e.value},setOpacity=function(e){options.opacity=e.value},setLength=function(e){options.length=e.value},setSource=function(e){clearInterval(intervalDraw),options.source=e.value,options.endLine=null,\"0\"==options.source?(nav.classList.remove(\"mouse\"),setDraw(!1)):(nav.classList.add(\"mouse\"),setDraw(!0))},setType=function(e){options.type=e.value,options.endLine=null,options.sizeKoof=\"3\"===e.value?5:2},setDraw=function(e){options.isDraw=e;var n=document.getElementById(layers[layers.length-1]);document.getElementById(\"undoBtn\")&&(document.getElementById(\"undoBtn\").disabled=e),e?(nav.classList.add(\"active\"),\"0\"===options.source&&(intervalDraw=setInterval(function(){drawCanvas(n)},Math.floor(Math.random()*(SPEED-SPEED/2+SPEED/2)*100)/100))):(nav.classList.remove(\"active\"),intervalDraw&&clearInterval(intervalDraw),hash&&socket.emit(\"drawing\",n.toDataURL()),addCanvas())},addCanvas=function(){var e=document.querySelector(\"#wrapper\"),n=document.createElement(\"canvas\");canvasId=\"canvas\"+num,n.setAttribute(\"id\",canvasId),e.appendChild(n);var t=document.getElementById(canvasId);layers.push(canvasId),layers.length>1&&document.getElementById(\"undoBtn\")&&(document.getElementById(\"undoBtn\").disabled=!1),canvasInit(t),num++},createCanvasByData=function(e,n){var t=document.querySelector(\"#wrapper\"),o=document.createElement(\"canvas\");canvasId=\"canvas\"+num,o.setAttribute(\"id\",canvasId),t.appendChild(o);var a=document.getElementById(canvasId);layers.push(canvasId),layers.length>1&&document.getElementById(\"undoBtn\")&&(document.getElementById(\"undoBtn\").disabled=!1),canvasInit(a,e,n),num++},createImage=function(e,n,t){var o=document.querySelector(\"#wrapper\"),a=document.createElement(\"img\");if(a.src=e,n){var r=o.querySelectorAll(\"canvas:not(.active)\"),s=o.querySelector(\"canvas.active\"),i=r[r.length-1];i?i.remove():s.remove()}o.appendChild(a),t&&addCanvas()},deleteCanvas=function(e){document.getElementById(layers[layers.length-2+(e||0)]).remove(),layers.splice(layers.length-2+(e||0),1),layers.length<2&&document.getElementById(\"undoBtn\")&&(document.getElementById(\"undoBtn\").disabled=!0),0===layers.length&&addCanvas()};window.addEventListener(\"keydown\",function(e){var n=window.event?event:e;90==n.keyCode&&n.ctrlKey&&layers.length>1&&deleteCanvas()}),window.addEventListener(\"resize\",debounce(function(){wW=window.innerWidth,wH=window.innerHeight,deleteCanvas(1),addCanvas()}));var onDrawingEvent=function(e){createCanvasByData(e,!1)},opacity=function(e){return e+Math.round(.4*Math.random())},color=function(e){return e===options.color?220:Math.round(Math.random()*((options.color>0?100:150)-10)+10)},float=function(){return Math.floor(10*Math.random()*(Math.random()<.5?-1:1))},sign=function(){return Math.random()<.5?-1:1},lineSize=function(){return Math.floor(Math.random()*options.length/options.sizeKoof)},raf=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),drawCanvas=function(e,n,t,o){var a=e.getContext(\"2d\"),r=o?o.point:{x:n&&t?n+float():Math.floor(Math.random()*wW*100)/100,y:n&&t?t+float():Math.floor(Math.random()*wH*100)/100},s=o?o.signY:sign(),i=o?o.signY:sign(),c=o?o.line:{sX:r.x+lineSize()*s,sY:r.y+lineSize()*i,eX:r.x+lineSize()*-s,eY:r.y+lineSize()*-i},u=o?o.type:options.type,d=o?o.radius:lineSize(10);a.beginPath(),a.moveTo(options.endLine?options.endLine.x:c.sX,options.endLine?options.endLine.y:c.sY),\"1\"===u?a.lineTo(c.eX,c.eY):\"2\"===u?(c.cX1=(c.sX+c.eX)/2+10*Math.random()*s,c.cY1=(c.sY+c.eY)/2+10*Math.random()*-i,a.quadraticCurveTo(c.cX1,c.cY1,c.eX,c.eY),options.endLine={x:c.eX,y:c.eY}):a.arc(c.sX,c.sY,d,0,2*Math.PI);var l=o?o.color:\"rgba(\"+color(\"1\")+\", \"+color(\"2\")+\", \"+color(\"3\")+\", \"+opacity(options.opacity)+\")\";return\"3\"===u?(a.fillStyle=l,a.fill()):(a.strokeStyle=l,a.stroke()),o?null:{type:options.type,point:r,line:c,signX:s,signY:i,radius:d,color:l}};\n//# sourceMappingURL=app.min.js.map\n","const opacity = function(opacity) {\n  return opacity + Math.round(Math.random() * 0.4);\n};\n\nconst color = function(color) {\n  return (color === options.color) ? 220 : Math.round(Math.random() * ((options.color > 0 ? 100 : 150) - 10) + 10);\n};\n\nconst float = function () {\n  return Math.floor((Math.random() * 10) * (Math.random() < 0.5 ? -1 : 1));\n};\n\nconst sign = function() {\n  return (Math.random() < 0.5 ? -1 : 1);\n};\n\nconst lineSize = function() {\n  return Math.floor((Math.random() * options.length / options.sizeKoof));\n};\n\nfunction repeatOften(func) {\n  func\n  requestAnimationFrame(repeatOften);\n}\n\nconst raf = (function() {\n  return (\n    window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function(callback) {\n      window.setTimeout(callback, 1000 / 60);\n    }\n  );\n})();\n\nconst drawCanvas = function(canvas, mX, mY, data) {\n  const ctx = canvas.getContext(\"2d\");\n  const point = data ? data.point : {\n    x: (mX && mY) ? mX + float() : Math.floor(Math.random() * (wW) * 100) / 100,\n    y: (mX && mY) ? mY + float() : Math.floor(Math.random() * (wH) * 100) / 100,\n  };\n  const signX = data ? data.signY : sign();\n  const signY = data ? data.signY : sign();\n  const line = data ? data.line : {\n    sX: point.x + lineSize() * signX,\n    sY: point.y + lineSize() * signY,\n    eX: point.x + lineSize() * -signX,\n    eY: point.y + lineSize() * -signY,\n  };\n  const type = data ? data.type : options.type;\n  const radius = data ? data.radius : lineSize(10);\n\n  ctx.beginPath();\n  ctx.moveTo(options.endLine ? options.endLine.x : line.sX, options.endLine ? options.endLine.y : line.sY);\n\n  if (type === '1') {\n    ctx.lineTo(line.eX, line.eY);\n  } else if (type === '2') {\n    line.cX1 = (line.sX + line.eX)/2 + Math.random() * 10 * signX;\n    line.cY1 = (line.sY + line.eY)/2 + Math.random() * 10 * -signY;\n\n    ctx.quadraticCurveTo(line.cX1,line.cY1,line.eX,line.eY);\n\n    options.endLine = {\n      x: line.eX,\n      y: line.eY,\n    }\n  } else {\n    ctx.arc(line.sX,line.sY,radius,0,2*Math.PI);\n  }\n\n  const getColor = data ? data.color : 'rgba(' + color('1') + ', ' + color('2') + ', ' + color('3') + ', ' + (opacity(options.opacity)) + ')';\n\n  if (type === '3') {\n    ctx.fillStyle = getColor;\n    ctx.fill()\n  } else {\n    ctx.strokeStyle = getColor;\n    ctx.stroke();\n  }\n\n  if (data) return null;\n\n  return {\n    type: options.type,\n    point,\n    line,\n    signX,\n    signY,\n    radius,\n    color: getColor\n  };\n};\n\nfunction canvasInit(canvas, data, isHistory) {\n  canvas.width = wW;\n  canvas.height = wH;\n\n  if (canvas.getContext) {\n    var ctx = canvas.getContext(\"2d\");\n\n    ctx.lineWidth = 1;\n    ctx.lineJoin = ctx.lineCap = 'round';\n\n    if (data) {\n      data.forEach((item, idx) => {\n        if (isHistory) {\n          drawCanvas(canvas, null, null, item)\n\n          if (idx === data.length -1) {\n            createImage(canvas.toDataURL(), true);\n          }\n        } else {\n          repeatOften(setTimeout(function(){\n            drawCanvas(canvas, null, null, item)\n\n            if (idx === data.length -1) {\n                createImage(canvas.toDataURL(), true);\n            }\n          }, 1000/60));\n        }\n      })\n    } else {\n      canvas.classList.add('active');\n\n      const drawing = [];\n\n      canvas.moveOnCanvas = function(e) {\n        if (options.isDraw && (options.source === '2' || (options.source === '1' && canvas.mousePress))) {\n          if (intervalDraw) {\n            clearInterval(intervalDraw);\n          }\n          const res = drawCanvas(canvas, e.touches ? e.touches[0].pageX : e.pageX, e.touches ? e.touches[0].pageY : e.pageY)\n          if (res) {\n            drawing.push(res);\n          }\n        }\n      };\n\n      canvas.mouseDown = function(e) {\n        if (e.which === 1) {\n          canvas.mousePress = true;\n          if (options.isDraw && options.source === '1') {\n            intervalDraw = setInterval(function() {\n              const res = drawCanvas(canvas, e.touches ? e.touches[0].pageX : e.pageX, e.touches ? e.touches[0].pageY : e.pageY)\n              if (res) {\n                drawing.push(res);\n              }\n            }, Math.floor(Math.random() * (SPEED - (SPEED / 2) + (SPEED / 2)) * 100) / 5)\n          }\n        }\n      };\n      canvas.mouseUp = function() {\n        if (options.source === '2' || (options.source === '1')) {\n          options.endLine = null;\n          if (intervalDraw) {\n            clearInterval(intervalDraw);\n          }\n\n          if (canvas.mousePress) {\n            if (hash) {\n              socket.emit('drawing', drawing);\n            }\n\n            canvas.removeEventListener('mousedown', this, false);\n            canvas.removeEventListener('touchstart', this, false);\n            canvas.removeEventListener('mousemove', this, false);\n            canvas.removeEventListener('touchmove', this, false);\n            canvas.removeEventListener('mouseup', this, false);\n            canvas.removeEventListener('touchend', this, false);\n\n            createImage(canvas.toDataURL(), true, true);\n          }\n        }\n\n        canvas.mousePress = false;\n        ctx.restore();\n      };\n\n      canvas.addEventListener('mousedown', canvas.mouseDown);\n      canvas.addEventListener('touchstart', canvas.mouseDown);\n      canvas.addEventListener('mousemove', canvas.moveOnCanvas);\n      canvas.addEventListener('touchmove', canvas.moveOnCanvas);\n      canvas.addEventListener('mouseup', canvas.mouseUp);\n      canvas.addEventListener('touchend', canvas.mouseUp);\n    }\n  }\n}\n"]}