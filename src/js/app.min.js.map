{"version":3,"sources":["app.js","canvas.js"],"names":["clearAll","node","document","getElementById","lastChild","deleteCanvas","addCanvas","debounce","func","timer","event","clearTimeout","setTimeout","httpGet","theUrl","xmlHttp","XMLHttpRequest","open","send","responseText","startSocket","hash","socket","io","connect","room","on","emit","onDrawingEvent","history","JSON","parse","data","length","forEach","item","createCanvasByData","sharePano","link","s4","Math","floor","random","toString","substring","href","window","location","init","wW","innerWidth","wH","innerHeight","remove","nav","querySelector","repeatOften","requestAnimationFrame","canvasInit","canvas","isHistory","width","height","getContext","ctx","lineWidth","lineJoin","lineCap","idx","drawCanvas","createImage","toDataURL","classList","add","drawing","moveOnCanvas","e","options","isDraw","source","mousePress","intervalDraw","clearInterval","res","touches","pageX","pageY","push","mouseDown","which","setInterval","SPEED","mouseUp","endLine","removeEventListener","this","restore","addEventListener","layers","num","canvasId","substr","opacity","color","type","sizeKoof","setColor","colorSelect","value","setOpacity","slider","setLength","setSource","selectObject","setDraw","setType","lineType","val","disabled","wrapper","createElement","setAttribute","appendChild","replace","createNew","src","nodes","querySelectorAll","activeNode","lastNode","n","splice","evtobj","keyCode","ctrlKey","round","float","sign","lineSize","raf","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","mX","mY","point","x","y","signX","signY","line","sX","sY","eX","eY","radius","beginPath","moveTo","lineTo","cX1","cY1","quadraticCurveTo","arc","PI","getColor","fillStyle","fill","strokeStyle","stroke"],"mappings":"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","file":"app.min.js","sourcesContent":["var layers = [];\nvar num = 0;\nvar canvasId = \"#canvas\";\nvar wW = window.innerWidth;\nvar wH = window.innerHeight;\nvar nav = document.querySelector(\"nav\");\nvar intervalDraw;\nvar socket;\nvar hash = window.location.hash.substr(1);\n\nconst SPEED = 1;\nconst options = {\n  opacity: 0.6,\n  length: 120,\n  color: '0',\n  source: '1',\n  type: '3',\n  isDraw: true,\n  mousePress: false,\n  endLine: null\n};\noptions.sizeKoof = options.type === '3' ? 5 : 2;\n\n\nconst setColor = function(colorSelect) {\n  options.color = colorSelect.value;\n};\n\nconst setOpacity = function (slider) {\n  options.opacity = slider.value;\n};\n\nconst setLength = function (slider) {\n  options.length = slider.value;\n};\n\nconst setSource = function(selectObject) {\n  clearInterval(intervalDraw);\n\n  options.source = selectObject.value;\n  options.endLine = null;\n\n  if (options.source == '0') {\n    nav.classList.remove('mouse');\n    setDraw(false);\n  } else {\n    nav.classList.add('mouse');\n    setDraw(true);\n  }\n};\n\nconst setType = function(lineType) {\n  options.type = lineType.value;\n  options.endLine = null;\n  options.sizeKoof = (lineType.value === '3') ? 5 : 2;\n};\n\nconst setDraw = function(val) {\n  options.isDraw = val;\n  const canvas = document.getElementById(layers[layers.length - 1]);\n\n  if (document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = val;\n  }\n\n  if (val) {\n    nav.classList.add('active')\n\n    if (options.source === '0') {\n      intervalDraw = setInterval(function() {\n        drawCanvas(canvas)\n      }, Math.floor(Math.random() * (SPEED - (SPEED / 2) + (SPEED / 2)) * 100) / 100)\n    }\n  } else {\n    nav.classList.remove('active')\n    if (intervalDraw) {\n      clearInterval(intervalDraw);\n    }\n\n    if (hash) {\n      socket.emit('drawing', canvas.toDataURL());\n    }\n\n    addCanvas();\n  }\n};\n\nvar addCanvas = function() {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"canvas\");\n\n  canvasId = \"canvas\" + num;\n  node.setAttribute(\"id\", canvasId);\n  wrapper.appendChild(node);\n\n  var canvas = document.getElementById(canvasId);\n  layers.push(canvasId);\n\n  if (layers.length > 1 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = false;\n  }\n  \n  canvasInit(canvas)\n\n  num++;\n};\n\nvar createCanvasByData = function(data, isHistory) {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"canvas\");\n  \n  canvasId = \"canvas\" + num;\n  node.setAttribute(\"id\", canvasId);\n  wrapper.appendChild(node);\n  \n  var canvas = document.getElementById(canvasId);\n  layers.push(canvasId);\n  \n  if (layers.length > 1 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = false;\n  }\n  \n  canvasInit(canvas, data, isHistory)\n  \n  num++;\n};\n\nvar createImage = function(data, replace, createNew) {\n  var wrapper = document.querySelector(\"#wrapper\");\n  var node = document.createElement(\"img\");\n  node.src = data;\n\n  if (replace) {\n    const nodes = wrapper.querySelectorAll('canvas:not(.active)');\n    const activeNode = wrapper.querySelector('canvas.active');\n    var lastNode = nodes[nodes.length- 1];\n    if (lastNode) {\n      lastNode.remove();\n    } else {\n      activeNode.remove();\n    }\n  }\n  wrapper.appendChild(node);\n\n  if (createNew) {\n    addCanvas();\n  }\n};\n\nvar deleteCanvas = function(n) {\n  var node = document.getElementById(layers[layers.length - 2 + (n ? n : 0)]);\n  node.remove();\n\n  layers.splice(layers.length - 2 + (n ? n : 0), 1);\n\n  if (layers.length < 2 && document.getElementById(\"undoBtn\")) {\n    document.getElementById(\"undoBtn\").disabled = true;\n  }\n\n  if(layers.length === 0) {\n    addCanvas();\n  }\n};\n\nfunction clearAll() {\n  var node = document.getElementById('wrapper');\n  while (node.lastChild) {\n    deleteCanvas()\n  }\n\n  addCanvas();\n}\n\nwindow.addEventListener('keydown', function(e) {\n  var evtobj = window.event ? event : e\n\n  if (evtobj.keyCode == 90 && evtobj.ctrlKey) {\n\n    if (layers.length > 1) {\n      deleteCanvas();\n    }\n  }\n});\n\nfunction debounce(func) {\n  var timer;\n\n  return function(event) {\n    if (timer) clearTimeout(timer);\n\n    timer = setTimeout(func, 300, event);\n  };\n}\n\nwindow.addEventListener(\"resize\", debounce(function() {\n  wW = window.innerWidth;\n  wH = window.innerHeight;\n\n  deleteCanvas(1);\n  addCanvas();\n}));\n\nvar onDrawingEvent = function(data) {\n  createCanvasByData(data, false);\n};\n\nfunction httpGet(theUrl) {\n  var xmlHttp = new XMLHttpRequest();\n  xmlHttp.open( \"GET\", theUrl, false ); // false for synchronous request\n  xmlHttp.send( null );\n  return xmlHttp.responseText;\n}\n\nfunction startSocket(hash) {\n  socket = io.connect();\n  var room = 'room-' + hash;\n\n  socket.on('connect', function() {\n    socket.emit('room', room);\n  });\n\n  socket.on('drawing', onDrawingEvent);\n\n  const history = JSON.parse(httpGet('/history?room=' + room)).data;\n\n  if (history && history.length > 0) {\n    history.forEach(item => {\n      createCanvasByData(item, true);\n    })\n  }\n}\n\nfunction sharePano(link) {\n  function guid() {\n    function s4() {\n      return Math.floor((1 + Math.random()) * 0x10000)\n        .toString(16)\n        .substring(1);\n    }\n    return s4() + s4();\n  }\n\n  const hash = guid();\n\n  link.href = window.location + '#' + hash\n}\n\nfunction init() {\n  wW = window.innerWidth;\n  wH = window.innerHeight;\n\n  if (hash) {\n    document.getElementById('clearBtn').remove();\n    document.getElementById('undoBtn').remove();\n    document.getElementById('shareBtn').remove();\n    startSocket(hash);\n  }\n\n  nav = document.querySelector(\"nav\");\n\n  addCanvas();\n}\n","const opacity = function(opacity) {\n  return opacity + Math.round(Math.random() * 0.4);\n};\n\nconst color = function(color) {\n  return (color === options.color) ? 220 : Math.round(Math.random() * ((options.color > 0 ? 100 : 150) - 10) + 10);\n};\n\nconst float = function () {\n  return Math.floor((Math.random() * 10) * (Math.random() < 0.5 ? -1 : 1));\n};\n\nconst sign = function() {\n  return (Math.random() < 0.5 ? -1 : 1);\n};\n\nconst lineSize = function() {\n  return Math.floor((Math.random() * options.length / options.sizeKoof));\n};\n\nfunction repeatOften(func) {\n  func\n  requestAnimationFrame(repeatOften);\n}\n\nconst raf = (function() {\n  return (\n    window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function(callback) {\n      window.setTimeout(callback, 1000 / 60);\n    }\n  );\n})();\n\nconst drawCanvas = function(canvas, mX, mY, data) {\n  const ctx = canvas.getContext(\"2d\");\n  const point = data ? data.point : {\n    x: (mX && mY) ? mX + float() : Math.floor(Math.random() * (wW) * 100) / 100,\n    y: (mX && mY) ? mY + float() : Math.floor(Math.random() * (wH) * 100) / 100,\n  };\n  const signX = data ? data.signY : sign();\n  const signY = data ? data.signY : sign();\n  const line = data ? data.line : {\n    sX: point.x + lineSize() * signX,\n    sY: point.y + lineSize() * signY,\n    eX: point.x + lineSize() * -signX,\n    eY: point.y + lineSize() * -signY,\n  };\n  const type = data ? data.type : options.type;\n  const radius = data ? data.radius : lineSize(10);\n\n  ctx.beginPath();\n  ctx.moveTo(options.endLine ? options.endLine.x : line.sX, options.endLine ? options.endLine.y : line.sY);\n\n  if (type === '1') {\n    ctx.lineTo(line.eX, line.eY);\n  } else if (type === '2') {\n    line.cX1 = (line.sX + line.eX)/2 + Math.random() * 10 * signX;\n    line.cY1 = (line.sY + line.eY)/2 + Math.random() * 10 * -signY;\n\n    ctx.quadraticCurveTo(line.cX1,line.cY1,line.eX,line.eY);\n\n    options.endLine = {\n      x: line.eX,\n      y: line.eY,\n    }\n  } else {\n    ctx.arc(line.sX,line.sY,radius,0,2*Math.PI);\n  }\n\n  const getColor = data ? data.color : 'rgba(' + color('1') + ', ' + color('2') + ', ' + color('3') + ', ' + (opacity(options.opacity)) + ')';\n\n  if (type === '3') {\n    ctx.fillStyle = getColor;\n    ctx.fill()\n  } else {\n    ctx.strokeStyle = getColor;\n    ctx.stroke();\n  }\n\n  if (data) return null;\n\n  return {\n    type: options.type,\n    point,\n    line,\n    signX,\n    signY,\n    radius,\n    color: getColor\n  };\n};\n\nfunction canvasInit(canvas, data, isHistory) {\n  canvas.width = wW;\n  canvas.height = wH;\n\n  if (canvas.getContext) {\n    var ctx = canvas.getContext(\"2d\");\n\n    ctx.lineWidth = 1;\n    ctx.lineJoin = ctx.lineCap = 'round';\n\n    if (data) {\n      data.forEach((item, idx) => {\n        if (isHistory) {\n          drawCanvas(canvas, null, null, item)\n\n          if (idx === data.length -1) {\n            createImage(canvas.toDataURL(), true);\n          }\n        } else {\n          repeatOften(setTimeout(function(){\n            drawCanvas(canvas, null, null, item)\n\n            if (idx === data.length -1) {\n                createImage(canvas.toDataURL(), true);\n            }\n          }, 1000/60));\n        }\n      })\n    } else {\n      canvas.classList.add('active');\n\n      const drawing = [];\n\n      canvas.moveOnCanvas = function(e) {\n        if (options.isDraw && (options.source === '2' || (options.source === '1' && canvas.mousePress))) {\n          if (intervalDraw) {\n            clearInterval(intervalDraw);\n          }\n          const res = drawCanvas(canvas, e.touches ? e.touches[0].pageX : e.pageX, e.touches ? e.touches[0].pageY : e.pageY)\n          if (res) {\n            drawing.push(res);\n          }\n        }\n      };\n\n      canvas.mouseDown = function(e) {\n        if (e.which === 1) {\n          canvas.mousePress = true;\n          if (options.isDraw && options.source === '1') {\n            intervalDraw = setInterval(function() {\n              const res = drawCanvas(canvas, e.touches ? e.touches[0].pageX : e.pageX, e.touches ? e.touches[0].pageY : e.pageY)\n              if (res) {\n                drawing.push(res);\n              }\n            }, Math.floor(Math.random() * (SPEED - (SPEED / 2) + (SPEED / 2)) * 100) / 5)\n          }\n        }\n      };\n      canvas.mouseUp = function() {\n        if (options.source === '2' || (options.source === '1')) {\n          options.endLine = null;\n          if (intervalDraw) {\n            clearInterval(intervalDraw);\n          }\n\n          if (canvas.mousePress) {\n            if (hash) {\n              socket.emit('drawing', drawing);\n            }\n\n            canvas.removeEventListener('mousedown', this, false);\n            canvas.removeEventListener('touchstart', this, false);\n            canvas.removeEventListener('mousemove', this, false);\n            canvas.removeEventListener('touchmove', this, false);\n            canvas.removeEventListener('mouseup', this, false);\n            canvas.removeEventListener('touchend', this, false);\n\n            createImage(canvas.toDataURL(), true, true);\n          }\n        }\n\n        canvas.mousePress = false;\n        ctx.restore();\n      };\n\n      canvas.addEventListener('mousedown', canvas.mouseDown);\n      canvas.addEventListener('touchstart', canvas.mouseDown);\n      canvas.addEventListener('mousemove', canvas.moveOnCanvas);\n      canvas.addEventListener('touchmove', canvas.moveOnCanvas);\n      canvas.addEventListener('mouseup', canvas.mouseUp);\n      canvas.addEventListener('touchend', canvas.mouseUp);\n    }\n  }\n}\n"]}